{"version":"0.2.0","body":"function main(workbook: ExcelScript.Workbook) {\r\n\tlet one = workbook.getWorksheets()[0];\r\n\r\n\tone.setName(\"Input\");\r\n\r\n\tlet newTable = workbook.addTable(one.getUsedRange(), true);\r\n\r\n\tnewTable.setName(\"avstemming\");\r\n\t\r\n\tlet posenummer = newTable.addColumn(-1, null, \"Posenummer\");\r\n\r\n\r\n\tposenummer.getRangeBetweenHeaderAndTotal().setFormula(\"=INDEX(MID([@Fritekst],ROW(INDIRECT(\\\"1:\\\"&LEN([@Fritekst]))),12),MATCH(TRUE,ISNUMBER(--MID([@Fritekst],ROW(INDIRECT(\\\"1:\\\"&LEN([@Fritekst]))),12)),0))\");\r\n\r\n\t\tone.getRange(\"D:E\").setNumberFormat(\"d/m/yy\");\r\n\r\n\tlet oversikt = workbook.addWorksheet(\"Oversikt\")\r\n\r\n\tlet pt = oversikt.addPivotTable(\"PIVOT\", newTable, oversikt.getRange(\"A1\"));\r\n\r\n\t/* Add \"Product line\" as a row hierarchy in the pivot table */\r\n\r\n\tpt.addRowHierarchy(pt.getHierarchy(\"Bil.artnavn\"));\r\n\r\n\tpt.addDataHierarchy(pt.getHierarchy(\"Beløp\"))\r\n\r\n\tpt.addColumnHierarchy(pt.getHierarchy(\"Posenummer\"));\r\n\r\n\r\n\tlet sok = workbook.addWorksheet(\"Søk\")\r\n\r\n\r\n\tsok.getRange(\"A1\").setFormulaLocal(\"=UNIQUE(avstemming[Posenummer])\");\r\n\r\n\tsok.getRange(\"A:A\").setColumnHidden(true);\r\n\r\n\tlet dataValidation: ExcelScript.DataValidation;\r\n\t// Data validation changed on range C3 on selectedSheet\r\n\tdataValidation = sok.getRange(\"C3\").getDataValidation();\r\n\tdataValidation.clear();\r\n\tdataValidation.setIgnoreBlanks(true);\r\n\tdataValidation.setPrompt({ showPrompt: true, title: \"\", message: \"\" });\r\n\tdataValidation.setErrorAlert({ showAlert: true, title: \"\", message: \"\", style: ExcelScript.DataValidationAlertStyle.stop });\r\n\tdataValidation.setRule({ list: { inCellDropDown: true, source: \"=$A:$A\" } });\r\n\t// Set range C2 on selectedSheet\r\n\tsok.getRange(\"C2\").setValue(\"Velg posenr\");\r\n\t// Set range C4 on selectedSheet\r\n\tsok.getRange(\"C4\").setFormula(\"=VSTACK(avstemming[#Headers],FILTER(avstemming,avstemming[Posenummer]=C3))\");\r\n\tsok.getCell(2, 2).setValue(\"Trykk her!\")\r\n\r\n\tsok.getRange(\"F:G\").setNumberFormat(\"d/m/yy\");\r\n}","description":"","parameterInfo":"{\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}